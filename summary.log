================================================================================
TRAINING DIAGNOSTICS SUMMARY
================================================================================
Log file: training.log
Generated: Wed Oct 22 07:53:20 +06 2025

================================================================================
1. MAX_GREEN BUG CHECK (Should see 44s for Phase 0-3, not 12s)
================================================================================

Sample of forced changes for Phase 0-3 (Major arterial):

If you see 'duration 12s >= MAX 12s' for Phase 0-3, the bug is NOT fixed!
Should see 'duration 44s >= MAX 44s' for Phase 0-3

================================================================================
2. FORCED MAX_GREEN CHANGES
================================================================================

Total forced changes: 36

Sample of recent forced changes:
[MAX_GREEN FORCED] TLS 3: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 16 → 0 (duration 10s >= MAX 10s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 16 → 0 (duration 10s >= MAX 10s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 12 → 0 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 12 → 0 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE

Target: < 2 per episode (< 200 total for 100 episodes)

================================================================================
3. STUCK WARNINGS (40s threshold)
================================================================================

Total stuck warnings: 0

✅ No stuck warnings! Agent switching before 40s threshold.

Target: Decreasing trend, ideally 0 by end of training

================================================================================
4. PHASE CHANGE RATE PROGRESSION
================================================================================

Recent phase change rates (last 20 episodes):
  Phase change rate: 17.8%
  Phase change rate: 18.4%
  Phase change rate: 19.0%
  Phase change rate: 19.4%
  Phase change rate: 19.4%
  Phase change rate: 19.4%
  Phase change rate: 19.1%
  Phase change rate: 19.2%
  Phase change rate: 17.2%
  Phase change rate: 17.6%
  Phase change rate: 16.4%
  Phase change rate: 17.1%
  Phase change rate: 16.5%
  Phase change rate: 17.2%
  Phase change rate: 18.2%
  Phase change rate: 17.1%
  Phase change rate: 18.6%
  Phase change rate: 18.7%
  Phase change rate: 15.8%
  Phase change rate: 18.4%

Target: 20-40% by end of training

================================================================================
5. EPISODE SUMMARY STATISTICS (Recent Episodes)
================================================================================

Recent episode summaries (last 5):
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 7200
  Phase changes executed: 1338
  Actions blocked (MIN_GREEN_TIME): 4232
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 7200
  Phase changes executed: 1348
  Actions blocked (MIN_GREEN_TIME): 4406
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 7200
  Phase changes executed: 1136
  Actions blocked (MIN_GREEN_TIME): 2850
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 7198
  Phase changes executed: 1322
  Actions blocked (MIN_GREEN_TIME): 4174

Target: Phase changes 1400-2000 per episode by end of training

================================================================================
6. REWARD PROGRESSION
================================================================================

Recent total rewards (last 20 episodes):
    TOTAL:      -0.2731
    TOTAL:      -0.2472
    TOTAL:      -0.7818
    TOTAL:      -0.5302
    TOTAL:      -0.4315
    TOTAL:      -0.9393
    TOTAL:      -0.3650
    TOTAL:      -0.2978
    TOTAL:      0.0058
    TOTAL:      -1.2921
    TOTAL:      -0.1396
    TOTAL:      -0.6277
    TOTAL:      -2.0211
    TOTAL:      -1.6289
    TOTAL:      -1.9648
    TOTAL:      -0.3091
    TOTAL:      -1.1170
    TOTAL:      -1.3023
    TOTAL:      -0.1298
    TOTAL:      -2.6620

Target: Trending upward (less negative), ideally > -2.0 by end

================================================================================
7. PEDESTRIAN PHASE ACTIVATION
================================================================================

Total pedestrian phase activations: 17690

✅ Agent IS using pedestrian phases!

Target: > 100 total activations

================================================================================
8. TRAINING PROGRESS
================================================================================

Latest training progress:

Training:  48%|████▊     | 48/100 [9:32:32<10:19:34, 714.90s/it]

Training:  49%|████▉     | 49/100 [9:46:10<10:34:04, 745.98s/it]

Training:  50%|█████     | 50/100 [10:00:17<10:47:00, 776.40s/it]

Training:  51%|█████     | 51/100 [10:03:41<8:13:49, 604.68s/it] 

Training:  52%|█████▏    | 52/100 [10:23:38<10:25:46, 782.21s/it]

================================================================================
9. SAFETY VIOLATIONS (Recent Episodes)
================================================================================

Recent safety summaries (last 5 episodes):
  Total Red Light Violations:  1021
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    7
  Total Distance Violations:   0
  Total Red Light Violations:  1134
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    4
  Total Distance Violations:   0
  Total Red Light Violations:  1055
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    4
  Total Distance Violations:   0
  Total Red Light Violations:  753
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    3
  Total Distance Violations:   0
  Total Red Light Violations:  1028
  ────────────────────────────────────────────────────────────────────────────

Target: Violations should stay low and not increase over time

================================================================================
10. QUICK HEALTH SUMMARY
================================================================================

Episodes completed: 52 / 100

Latest phase change rate:   Phase change rate: 18.4%

Latest reward:     TOTAL:      -2.6620

Forced changes per episode: .69 (target: < 2.0)

================================================================================
SUCCESS INDICATORS CHECKLIST
================================================================================

❌ MAX_GREEN Bug: STILL PRESENT (Phase 0-3 showing 12s instead of 44s)
✅ Phase Change Rate: GOOD (18.4% - approaching target 20-40%)
✅ Forced Changes: EXCELLENT (.69 per episode - target < 2.0)
✅ Stuck Warnings: PERFECT (0 warnings - agent switching proactively)
✅ Pedestrian Phases: EXCELLENT (17690 activations)

================================================================================
END OF DIAGNOSTICS
================================================================================

For detailed episode-by-episode breakdown, use:
  ./scripts/drl/parse_training_log.sh training.log

