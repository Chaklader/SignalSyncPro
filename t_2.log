================================================================================
TRAINING DIAGNOSTICS SUMMARY
================================================================================
Log file: training.log
Generated: Wed Oct 22 14:26:53 +06 2025

================================================================================
1. MAX_GREEN BUG CHECK (Should see 44s for Phase 0-3, not 12s)
================================================================================

Sample of forced changes for Phase 0-3 (Major arterial):
[MAX_GREEN FORCED] TLS 3: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE

If you see 'duration 12s >= MAX 12s' for Phase 0-3, the bug is NOT fixed!
Should see 'duration 44s >= MAX 44s' for Phase 0-3

================================================================================
2. FORCED MAX_GREEN CHANGES
================================================================================

Total forced changes: 366

Sample of recent forced changes:
[MAX_GREEN FORCED] TLS 3: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 4 → 8 (duration 12s >= MAX 12s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 0 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 0 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 3: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE
[MAX_GREEN FORCED] TLS 6: Phase 1 → 4 (duration 44s >= MAX 44s) 🔴 FORCED CHANGE

Target: < 2 per episode (< 200 total for 100 episodes)

================================================================================
3. STUCK WARNINGS (40s threshold)
================================================================================

Total stuck warnings: 90

Sample of stuck warnings:
[STUCK WARNING] TLS 3: Continuous Continue for 40s (phase 0, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 6: Continuous Continue for 40s (phase 0, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 3: Continuous Continue for 40s (phase 1, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 6: Continuous Continue for 40s (phase 1, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 3: Continuous Continue for 40s (phase 0, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 6: Continuous Continue for 40s (phase 0, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 3: Continuous Continue for 40s (phase 0, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 6: Continuous Continue for 40s (phase 0, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 3: Continuous Continue for 40s (phase 1, max 44s, penalty: -6.000)
[STUCK WARNING] TLS 6: Continuous Continue for 40s (phase 1, max 44s, penalty: -6.000)

Target: Decreasing trend, ideally 0 by end of training

================================================================================
4. PHASE CHANGE RATE PROGRESSION
================================================================================

Recent phase change rates (last 20 episodes):
  Phase change rate: 12.6%
  Phase change rate: 12.0%
  Phase change rate: 14.7%
  Phase change rate: 12.9%
  Phase change rate: 12.8%
  Phase change rate: 11.9%
  Phase change rate: 13.4%
  Phase change rate: 14.0%
  Phase change rate: 13.4%
  Phase change rate: 12.6%
  Phase change rate: 12.7%
  Phase change rate: 11.9%
  Phase change rate: 11.3%
  Phase change rate: 12.2%
  Phase change rate: 11.0%
  Phase change rate: 11.5%
  Phase change rate: 9.9%
  Phase change rate: 11.0%
  Phase change rate: 11.7%
  Phase change rate: 11.8%

Target: 20-40% by end of training

================================================================================
5. EPISODE SUMMARY STATISTICS (Recent Episodes)
================================================================================

Recent episode summaries (last 5):
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 7174
  Phase changes executed: 790
  Actions blocked (MIN_GREEN_TIME): 1780
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 7178
  Phase changes executed: 840
  Actions blocked (MIN_GREEN_TIME): 1938
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 7176
  Phase changes executed: 844
  Actions blocked (MIN_GREEN_TIME): 2016
--
[EPISODE SUMMARY] Phase Change Statistics:
  Total actions attempted: 0
  Phase changes executed: 0
  Actions blocked (MIN_GREEN_TIME): 0

Target: Phase changes 1400-2000 per episode by end of training

================================================================================
6. REWARD PROGRESSION
================================================================================

Recent total rewards (last 20 episodes):
    TOTAL:      -0.4521
    TOTAL:      -4.2362
    TOTAL:      -0.1937
    TOTAL:      -0.3440
    TOTAL:      -0.8308
    TOTAL:      -0.2092
    TOTAL:      -1.6734
    TOTAL:      -1.2885
    TOTAL:      -0.2060
    TOTAL:      -0.8954
    TOTAL:      -2.5062
    TOTAL:      -3.6807
    TOTAL:      -0.3924
    TOTAL:      -0.6158
    TOTAL:      -1.9160
    TOTAL:      -1.1597
    TOTAL:      -0.4458
    TOTAL:      -3.6329
    TOTAL:      -2.4803
    TOTAL:      -0.7647

Target: Trending upward (less negative), ideally > -2.0 by end

================================================================================
7. PEDESTRIAN PHASE ACTIVATION
================================================================================

Total pedestrian phase activations: 25202

✅ Agent IS using pedestrian phases!

Target: > 100 total activations

================================================================================
8. TRAINING PROGRESS
================================================================================

Latest training progress:
Training:  96%|█████████▌| 96/100 [16:19:51<30:44, 461.19s/it]
Training:  97%|█████████▋| 97/100 [16:26:01<21:41, 433.96s/it]
Training:  98%|█████████▊| 98/100 [16:35:30<15:48, 474.48s/it]
Training:  99%|█████████▉| 99/100 [16:49:30<09:43, 583.90s/it]
Training: 100%|██████████| 100/100 [16:56:27<00:00, 533.96s/it]Training: 100%|██████████| 100/100 [16:56:27<00:00, 609.88s/it]

================================================================================
9. SAFETY VIOLATIONS (Recent Episodes)
================================================================================

Recent safety summaries (last 5 episodes):
  Total Red Light Violations:  635
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    9
  Total Distance Violations:   0
  Total Red Light Violations:  825
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    7
  Total Distance Violations:   0
  Total Red Light Violations:  769
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    3
  Total Distance Violations:   0
  Total Red Light Violations:  772
  ────────────────────────────────────────────────────────────────────────────
--
[FINAL SAFETY SUMMARY] Episode Complete
================================================================================
  Total Headway Violations:    3
  Total Distance Violations:   0
  Total Red Light Violations:  772
  ────────────────────────────────────────────────────────────────────────────

Target: Violations should stay low and not increase over time

================================================================================
10. QUICK HEALTH SUMMARY
================================================================================

Episodes completed: 100 / 100

Latest phase change rate:   Phase change rate: 11.8%

Latest reward:     TOTAL:      -0.7647

Forced changes per episode: 3.66 (target: < 2.0)

================================================================================
SUCCESS INDICATORS CHECKLIST
================================================================================

❌ MAX_GREEN Bug: STILL PRESENT (Phase 0-3 showing 12s instead of 44s)
⚠️  Phase Change Rate: IMPROVING (11.8% - target 20-40%)
⚠️  Forced Changes: GOOD (3.66 per episode - target < 2.0)
⚠️  Stuck Warnings: LOW (90 total - acceptable)
✅ Pedestrian Phases: EXCELLENT (25202 activations)

================================================================================
END OF DIAGNOSTICS
================================================================================

For detailed episode-by-episode breakdown, use:
  ./scripts/drl/parse_training_log.sh training.log

